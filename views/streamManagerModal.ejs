<div id="streams-modal" 
     class="modal fade" 
     tabindex="-1" 
     role="dialog">
  <div class="modal-dialog modal-fullscreen" 
       role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Streams</h4>
        <div class="pull-right">
          <%- include("streamManagerModalActions") %>
        </div>
      </div>
      <div class="modal-body">
        <form id="new_stream_form" 
              name="new_stream_form">
          <div class="input-group mb-3">
            <input type="text" 
                   name="new_stream" 
                   id="new_stream" 
                   value="" 
                   placeholder="Add stream..." 
                   class="form-control"
                   onkeyup="MT.manager.toggleAddButton();"
                   autocomplete="on"
                   autocorrect="off"
                   spellcheck="false"
                   autocapitalize="none"
                   autofocus />
            <button type="button" 
                    class="btn btn-success" 
                    id="add-stream-btn" 
                    onclick="MT.manager.addToTable(document.getElementById('new_stream').value);"
                    title="Add a new stream."
                    disabled=disabled>
              <i class="fa fa-plus"></i>
            </button>
          </div>
        </form>        
        <%- include("streamManagerModalCurrentStreams") %>
        <%- include("streamManagerModalRecentStreams") %>
      </div>
      <div class="modal-footer">
        Mute Streams on Start&nbsp;
        <label class="switch">
          <input type="checkbox"
                 class="checkbox"
                 id="mutedSetting"
                 name="mutedSetting"
                 value="false">
          <span class="toggle-thumb">
            <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" style="fill:#4ADE80;transform:;-ms-filter:"><path d="M10 15.586L6.707 12.293 5.293 13.707 10 18.414 19.707 8.707 18.293 7.293z"></path></svg>
  
            <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" style="fill:#F87171;transform:;-ms-filter:"><path d="M16.192 6.344L11.949 10.586 7.707 6.344 6.293 7.758 10.535 12 6.293 16.242 7.707 17.656 11.949 13.414 16.192 17.656 17.606 16.242 13.364 12 17.606 7.758z"></path></svg>
          </span>
        </label>
      </div>
    </div>
  </div>
</div>

<input type="hidden"
       id="order-changed"
       value="false" />

<script type="text/javascript">

  let streamsList = document.getElementById("streams-list-tbody");
  let recentStreamsList = document.getElementById("recent-streams-list-tbody");
  let sortable = Sortable.create(streamsList, {
    animation: 100,
    draggable: ".streams-modal-table-tr",
    onEnd: (evt) => {
      document.getElementById("order-changed").value = "true";
    }
  });

  document.getElementById("new_stream").addEventListener("keypress", (event) => {
    if (event.keyCode === 13) {
      document.getElementById("add-stream-btn").click();
      event.preventDefault();
      return false;
    }
  });

  document.addEventListener("keydown", (event) => {
    if (event.ctrlKey || event.metaKey) {
      switch (String.fromCharCode(event.which).toLowerCase()) {
      case "s":
        event.preventDefault();
        document.getElementById("save-btn").click();
        break;
      }
    }
  });
</script>